<!DOCTYPE html>
<html lang="vi">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>CVE-2025-32650 Analysis &amp; POC - w41bu1</title><meta name="Description" content="Security Vulnerability in WordPress Accessibility Suite Plugin."><meta property="og:url" content="http://localhost:1313/vi/2025-09-26-cve-2025-32650/">
  <meta property="og:site_name" content="w41bu1">
  <meta property="og:title" content="CVE-2025-32650 Analysis &amp; POC">
  <meta property="og:description" content="Security Vulnerability in WordPress Accessibility Suite Plugin.">
  <meta property="og:locale" content="vi">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-09-26T10:36:00+07:00">
    <meta property="article:modified_time" content="2025-09-26T10:36:00+07:00">
    <meta property="article:tag" content="Analyst">
    <meta property="article:tag" content="Plugin">
    <meta property="article:tag" content="Sqli">
    <meta property="og:image" content="http://localhost:1313/logo.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/logo.png">
  <meta name="twitter:title" content="CVE-2025-32650 Analysis &amp; POC">
  <meta name="twitter:description" content="Security Vulnerability in WordPress Accessibility Suite Plugin.">
<meta name="application-name" content="LoveIt">
<meta name="apple-mobile-web-app-title" content="LoveIt">
<meta name="referrer" content="no-referrer" /><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://localhost:1313/vi/2025-09-26-cve-2025-32650/" /><link rel="prev" href="http://localhost:1313/vi/2025-09-25-cve-2025-58604/" /><link rel="next" href="http://localhost:1313/vi/2025-09-27-cve-2025-48281/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/css/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "CVE-2025-32650 Analysis \u0026 POC",
        "inLanguage": "vi",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/localhost:1313\/vi\/2025-09-26-cve-2025-32650\/"
        },"image": ["http:\/\/localhost:1313\/images\/Apple-Devices-Preview.png"],"genre": "posts","keywords": "analyst, plugin, sqli","wordcount":  901 ,
        "url": "http:\/\/localhost:1313\/vi\/2025-09-26-cve-2025-32650\/","datePublished": "2025-09-26T10:36:00+07:00","dateModified": "2025-09-26T10:36:00+07:00","license": "Tác phẩm này được cấp phép theo Giấy phép Creative Commons Ghi công - Phi thương mại 4.0 Quốc tế.","publisher": {
            "@type": "Organization",
            "name": "w41bu1","logo": {
                    "@type": "ImageObject",
                    "url": "http:\/\/localhost:1313\/images\/avatar.jpeg",
                    "width":  736 ,
                    "height":  736 
                }},"author": {
                "@type": "Person",
                "name": "w41bu1"
            },"description": "Security Vulnerability in WordPress Accessibility Suite Plugin."
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script>
          const query = window.matchMedia('(prefers-color-scheme: dark)');
          function applyTheme() {
            let theme = window.localStorage?.getItem('theme') || 'auto';
            let isDark = theme === 'dark' || (theme === 'auto' && query.matches);
            document.body.setAttribute('theme', isDark? 'dark' : 'light');
            document.body.setAttribute('cfg-theme', theme);
          }

          applyTheme();
          query.addEventListener('change', applyTheme);
        </script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/vi/" title="w41bu1"><span class="header-title-pre"><i class='fa-solid fa-bug fa-fw' aria-hidden='true'></i></span>w41bu1</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/vi/posts/"> Posts </a><a class="menu-item" href="/vi/tags/"> Tags </a><a class="menu-item" href="/vi/categories/"> Categories </a><a class="menu-item" href="/vi/categories/documentation/"> Docs </a><a class="menu-item" href="/vi/about/"> About </a><a class="menu-item" href="https://github.com/dillonzq/LoveIt" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw' aria-hidden='true'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Tìm kiếm..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Tìm kiếm">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Xoá">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Đổi chủ đề">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a><a href="javascript:void(0);" class="menu-item language" title="Chọn Ngôn ngữ">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>                      
                    <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/2025-09-26-cve-2025-32650/">English</option><option value="/vi/2025-09-26-cve-2025-32650/" selected>Vietnamese</option></select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/vi/" title="w41bu1"><span class="header-title-pre"><i class='fa-solid fa-bug fa-fw' aria-hidden='true'></i></span>w41bu1</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Tìm kiếm..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Tìm kiếm">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Xoá">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Huỷ
                    </a>
                </div><a class="menu-item" href="/vi/posts/" title="">Posts</a><a class="menu-item" href="/vi/tags/" title="">Tags</a><a class="menu-item" href="/vi/categories/" title="">Categories</a><a class="menu-item" href="/vi/categories/documentation/" title="">Docs</a><a class="menu-item" href="/vi/about/" title="">About</a><a class="menu-item" href="https://github.com/dillonzq/LoveIt" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw' aria-hidden='true'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Đổi chủ đề">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="Chọn Ngôn ngữ">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/2025-09-26-cve-2025-32650/">English</option><option value="/vi/2025-09-26-cve-2025-32650/" selected>Vietnamese</option></select>
                </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Nội dung</h2>
            <div class="toc-content always-active" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">CVE-2025-32650 Analysis & POC</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://w41bu1.github.io" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>w41bu1</a></span>&nbsp;<span class="post-category">trong <a href="/vi/categories/cve-analyst/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>CVE Analyst</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2025-09-26">2025-09-26</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;901 từ&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;5 phút&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/2025-09-26-cve-2025-32650/app.png"
        data-srcset="/2025-09-26-cve-2025-32650/app.png, /2025-09-26-cve-2025-32650/app.png 1.5x, /2025-09-26-cve-2025-32650/app.png 2x"
        data-sizes="auto"
        alt="/2025-09-26-cve-2025-32650/app.png"
        title="Security Vulnerability in WordPress Accessibility Suite Plugin." width="1909" height="855" /></div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Nội dung</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#analysis">Analysis</a>
      <ul>
        <li><a href="#patch-diff">Patch Diff</a></li>
        <li><a href="#how-it-work">How it work?</a></li>
      </ul>
    </li>
    <li><a href="#exploit">Exploit</a>
      <ul>
        <li><a href="#detect-sqli">Detect SQLi</a></li>
        <li><a href="#get-first-letter-of-database-name">Get First Letter of Database Name</a></li>
      </ul>
    </li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><hr>
<p>Lỗ hổng xảy ra trên plugin <strong>Accessibility Suite</strong> của WordPress trước phiên bản <strong>4.19</strong>. Điều này có thể cho phép kẻ tấn công trực tiếp tương tác với cơ sở dữ liệu của bạn, bao gồm không giới hạn ở việc đánh cắp thông tin.</p>
<ul>
<li><strong>CVE ID</strong>: <a href="https://www.cve.org/CVERecord?id=CVE-2025-32650" target="_blank" rel="noopener noreffer ">CVE-2025-32650</a></li>
<li><strong>Product</strong>: <a href="https://wordpress.org/plugins/online-accessibility/" target="_blank" rel="noopener noreffer ">WordPress Accessibility Suite Plugin</a></li>
<li><strong>Vulnerability Type</strong>: SQL Injection</li>
<li><strong>Affected Versions</strong>: &lt;= 4.18</li>
<li><strong>CVSS severity</strong>: High (8.5)</li>
<li><strong>Required Privilege</strong>: Subscriber</li>
</ul>
<hr>
<h2 id="requirements">Requirements</h2>
<ul>
<li><a href="https://w41bu1.github.io/posts/wordpress-local-and-debugging/" target="_blank" rel="noopener noreffer "><strong>Local WordPress and Debugging</strong></a></li>
<li><strong>Accessibility Suite</strong>:  v4.18(vul) và v4.19(fix)</li>
<li><strong>diff tool</strong>: <strong>meld</strong> hoặc bất cứ tool nào có thể compare để thấy được sự khác biệt giữa 2 version</li>
</ul>
<hr>
<h2 id="analysis">Analysis</h2>
<p>Ứng dụng chưa thực hiện ép kiểu cho <strong>input</strong> và mặc dù có sử dụng <code>prepare()</code> để chống SQLi, nhưng do triển khai không đúng nên lỗ hổng SQLi vẫn tồn tại.</p>
<h3 id="patch-diff">Patch Diff</h3>
<p>Dùng diff tool bất kì để so sánh sự khác biệt giữa bản lỗi và bản vá.
Có sự khác biệt rõ ở file <strong>includes/classes/Helper.php</strong></p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-php">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Sao chép vào bộ nhớ tạm"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">static</span> <span class="k">function</span> <span class="nf">save_false_positive</span><span class="p">(</span><span class="nv">$scan_id</span><span class="p">,</span> <span class="nv">$issue_id</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// other logic
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span><span class="p">(</span><span class="o">!</span> <span class="nx">is_admin</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// other logic
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nv">$list</span> <span class="o">=</span> <span class="nx">json_decode</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$wpdb</span><span class="o">-&gt;</span><span class="na">get_results</span><span class="p">(</span><span class="nv">$wpdb</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span><span class="s2">&#34;SELECT list FROM  </span><span class="si">$table_name</span><span class="s2"> WHERE scan_id = </span><span class="si">$scan_id</span><span class="s2">&#34;</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">list</span> <span class="c1">// phpcs:ignore
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div></div>
<p>Bản vá đã truyền <code>$scan_id</code> như tham số vào câu query. SQL injection được phòng ngừa vì biến không được nối trực tiếp vào query nữa.</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-php">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Sao chép vào bộ nhớ tạm"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">static</span> <span class="k">function</span> <span class="nf">save_false_positive</span><span class="p">(</span><span class="nv">$scan_id</span><span class="p">,</span> <span class="nv">$issue_id</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// other logic
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span><span class="p">(</span><span class="o">!</span> <span class="nx">is_admin</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// other logic
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nv">$scan_id</span> <span class="o">=</span> <span class="nx">absint</span><span class="p">(</span><span class="nv">$scan_id</span><span class="p">);</span> <span class="c1">// Ensure scan_id is a positive integer
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$scan_id</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">[</span><span class="s2">&#34;status&#34;</span> <span class="o">=&gt;</span> <span class="s2">&#34;failed&#34;</span><span class="p">,</span> <span class="s2">&#34;msg&#34;</span> <span class="o">=&gt;</span> <span class="s2">&#34;Invalid scan ID&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// Get list using properly prepared query
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nv">$query</span> <span class="o">=</span> <span class="nv">$wpdb</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;SELECT list FROM %i WHERE scan_id = %d&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$table_name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$scan_id</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nv">$result</span> <span class="o">=</span> <span class="nv">$wpdb</span><span class="o">-&gt;</span><span class="na">get_results</span><span class="p">(</span><span class="nv">$query</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div></div>
<p><figure><a class="lightgallery" href="/2025-09-26-cve-2025-32650/patch_diff.png" title="patch diff" data-thumbnail="/2025-09-26-cve-2025-32650/patch_diff.png" data-sub-html="<h2>Patch diff</h2><p>patch diff</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/2025-09-26-cve-2025-32650/patch_diff.png"
            data-srcset="/2025-09-26-cve-2025-32650/patch_diff.png, /2025-09-26-cve-2025-32650/patch_diff.png 1.5x, /2025-09-26-cve-2025-32650/patch_diff.png 2x"
            data-sizes="auto"
            alt="/2025-09-26-cve-2025-32650/patch_diff.png" width="487" height="122" />
    </a><figcaption class="image-caption">Patch diff</figcaption>
    </figure></p>
<h3 id="how-it-work">How it work?</h3>
<p>Lỗ hổng nằm trong hàm tĩnh <code>save_false_positive</code> của class <code>Helper</code> thuộc file <strong>includes/classes/Helper.php</strong>. Để xác định nơi nó được gọi, ta tìm kiếm với tự khóa <code>save_false_positive</code> trong thư mục chứa plugin.</p>
<p><figure><a class="lightgallery" href="/2025-09-26-cve-2025-32650/search_1.png" title="search 1" data-thumbnail="/2025-09-26-cve-2025-32650/search_1.png" data-sub-html="<h2>Search save_false_positive</h2><p>search 1</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/2025-09-26-cve-2025-32650/search_1.png"
            data-srcset="/2025-09-26-cve-2025-32650/search_1.png, /2025-09-26-cve-2025-32650/search_1.png 1.5x, /2025-09-26-cve-2025-32650/search_1.png 2x"
            data-sizes="auto"
            alt="/2025-09-26-cve-2025-32650/search_1.png" width="1628" height="409" />
    </a><figcaption class="image-caption">Search save_false_positive</figcaption>
    </figure></p>
<p>👉 <code>save_false_positive</code> được <code>callback</code> của action hook <code>wp_ajax_ONLINE_ADAv4/save_false_positive</code> gọi.</p>
<p>Khi <strong>POST</strong> request được gửi đến <code>/wp-admin/admin-ajax.php</code> với <code>action</code>=<code>ONLINE_ADAv4/save_false_positive</code> callback được gọi.
Trong request cần 2 <strong>POST</strong> param <code>issue_id</code> và <code>scan_id</code>. Nếu không, ứng dụng sẽ trả về:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-json">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Sao chép vào bộ nhớ tạm"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;status&#34;</span><span class="p">:</span><span class="s2">&#34;failed&#34;</span><span class="p">,</span><span class="nt">&#34;msg&#34;</span><span class="p">:</span><span class="s2">&#34;Did not receive the scan ID or the issue ID&#34;</span><span class="p">}</span></span></span></code></pre></div></div>
<p><code>save_false_positive</code> được gọi với đối số <code>issue_id</code> và <code>scan_id</code>. Các đối số này sẽ bị escape bởi <a href="https://patchstack.com/academy/wordpress/vulnerabilities/sql-injection/#magic-quotes" target="_blank" rel="noopener noreffer "><strong>magic quotes</strong></a> trong WordPress vì lấy trực tiếp từ <strong>POST</strong> request.</p>
<p>Ứng dụng check xem người dùng có quyền truy cập vào trang admin không. Nếu không, trả về chuỗi rỗng.</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-php">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Sao chép vào bộ nhớ tạm"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span> <span class="nx">is_admin</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div></div>
<p>Sau đó các đối số trực tiếp truyền vào câu query chứa lỗ hổng SQLi rồi thực thi.</p>
<hr>
<h2 id="exploit">Exploit</h2>
<h3 id="detect-sqli">Detect SQLi</h3>
<p>Gửi <strong>POST request</strong> chứa payload SQLi. Vì chỉ cần là user có quyền truy cập vào trang admin, nên ta tạo user với <code>role:subcriber</code> có <strong>privilege thấp nhất</strong>.</p>
<p>Trong WordPress, user có role cao hơn sẽ kế thừa cả <strong>privilege</strong> role thấp hơn. Nên chỉ cần user <code>subcriber</code> gửi payload thành công thì tất cả user còn lại đều có thể. Đúng với mô tả của CVE</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-http">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Sao chép vào bộ nhớ tạm"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="nf">POST</span> <span class="nn">/wp-admin/admin-ajax.php</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Host</span><span class="o">:</span> <span class="l">localhost</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Type</span><span class="o">:</span> <span class="l">application/x-www-form-urlencoded; charset=UTF-8</span>
</span></span><span class="line"><span class="cl"><span class="err">...</span>
</span></span><span class="line"><span class="cl">Cookie: cookie_here
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">action=ONLINE_ADAv4/save_false_positive&amp;issue_id=1&amp;scan_id=1 UNION SELECT SLEEP(5)</span></span></code></pre></div></div>
<p>Khi đó câu query sẽ trở thành</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-sql">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Sao chép vào bộ nhớ tạm"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="k">FROM</span><span class="w">  </span><span class="n">wp_oada_false_positives</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">scan_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">SLEEP</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span></span></span></code></pre></div></div>
<p><figure><a class="lightgallery" href="/2025-09-26-cve-2025-32650/time_response.png" title="time response" data-thumbnail="/2025-09-26-cve-2025-32650/time_response.png" data-sub-html="<h2>Time response with SQLi payload</h2><p>time response</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/2025-09-26-cve-2025-32650/time_response.png"
            data-srcset="/2025-09-26-cve-2025-32650/time_response.png, /2025-09-26-cve-2025-32650/time_response.png 1.5x, /2025-09-26-cve-2025-32650/time_response.png 2x"
            data-sizes="auto"
            alt="/2025-09-26-cve-2025-32650/time_response.png" width="366" height="246" />
    </a><figcaption class="image-caption">Time response with SQLi payload</figcaption>
    </figure></p>
<p>👉 Dựa trên thời gian phản hồi =&gt; payload hoạt động.</p>
<p><strong>Các technique có thể sử dụng trong trường hợp table rỗng</strong>:</p>
<ul>
<li>
<p><strong>UNION</strong>: vì nó không phụ thuộc vào dữ liệu bảng của câu query trước đó, nhưng cần phải tìm được số cột tương ứng với truy vấn trước đó.</p>
</li>
<li>
<p><strong>Subquery</strong>:</p>
<ul>
<li><strong>Subquery trong mệnh đề WHERE</strong>: MySQL có thể tối ưu hóa và bỏ qua subquery nếu kết quả có thể xác định sớm. Nếu bảng không có dữ liệu, kết quả cuối cùng sẽ là tập rỗng, MySQL không cần thực thi <code>SLEEP()</code>.</li>
<li><strong>Subquery trong mệnh đề FROM</strong>: Truy vấn con được coi là bảng tạm thời. MySQL phải thực thi truy vấn con này đầu tiên để tạo bảng tạm thời, sau đó mới thực thi truy vấn chính.</li>
</ul>
</li>
</ul>
<p><figure><a class="lightgallery" href="https://www.kdnuggets.com/wp-content/uploads/ferrer_essential_guide_sql_execution_order_6.png" title="SQL Excution Order" data-thumbnail="https://www.kdnuggets.com/wp-content/uploads/ferrer_essential_guide_sql_execution_order_6.png" data-sub-html="<h2>SQL Execution Order Diagram</h2><p>SQL Excution Order</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="https://www.kdnuggets.com/wp-content/uploads/ferrer_essential_guide_sql_execution_order_6.png"
            data-srcset="https://www.kdnuggets.com/wp-content/uploads/ferrer_essential_guide_sql_execution_order_6.png, https://www.kdnuggets.com/wp-content/uploads/ferrer_essential_guide_sql_execution_order_6.png 1.5x, https://www.kdnuggets.com/wp-content/uploads/ferrer_essential_guide_sql_execution_order_6.png 2x"
            data-sizes="auto"
            alt="https://www.kdnuggets.com/wp-content/uploads/ferrer_essential_guide_sql_execution_order_6.png" />
    </a><figcaption class="image-caption">SQL Execution Order Diagram</figcaption>
    </figure></p>
<h3 id="get-first-letter-of-database-name">Get First Letter of Database Name</h3>
<p>Điều kiện tiên quyết để <strong>dump được hết data</strong> là phải dump được 1 ký tự bất kỳ của tên database, nếu lấy được thì gần như toàn bộ data đều dump được.</p>
<p>Gửi request với <strong>SQLi payload</strong>:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-http">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Sao chép vào bộ nhớ tạm"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="nf">POST</span> <span class="nn">/wp-admin/admin-ajax.php</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Host</span><span class="o">:</span> <span class="l">localhost</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Type</span><span class="o">:</span> <span class="l">application/x-www-form-urlencoded; charset=UTF-8</span>
</span></span><span class="line"><span class="cl"><span class="err">...</span>
</span></span><span class="line"><span class="cl">Cookie: cookie_here
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">action=ONLINE_ADAv4/save_false_positive&amp;issue_id=1&amp;scan_id=1 UNION SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1)</span></span></code></pre></div></div>
<p>Sử dụng <code>SUBSTRING()</code> để lấy ký tự đầu tiên của <strong>database name</strong>, <code>IF()</code> trả về <code>SLEEP(5)</code> nếu ký tự đó là <code>0x77</code>(&lsquo;w&rsquo;)</p>
<p>Sử dụng hex encoding <code>w</code> thành <code>0x77</code> vì như phân tích <a href="#how-it-work" rel="">ở trên</a>, <code>scan_id</code> sẽ bị escape.</p>
<p>👉 Dựa trên thời gian phản hồi =&gt; kí tự đầu tiên đúng là <code>w</code>.</p>
<hr>
<h2 id="conclusion">Conclusion</h2>
<p>Lỗ hổng <strong>CVE-2025-32650</strong> trong plugin WordPress <strong>Accessibility Suite</strong> trước phiên bản <strong>4.19</strong> xuất phát từ việc triển khai không đúng hàm <code>$wpdb-&gt;prepare()</code> dẫn đến lỗ hổng SQL Injection.</p>
<p>Bản vá chính thức đã triển khai đúng <code>$wpdb-&gt;prepare</code>, giúp đảm bảo dữ liệu đầu vào được kiểm soát và an toàn hơn.</p>
<p><strong>Key takeaways</strong>:</p>
<ul>
<li>Luôn sử dụng <code>$wpdb-&gt;prepare()</code> khi làm việc với database trong WordPress để tránh SQL Injection.</li>
<li>Thường xuyên cập nhật plugin và kiểm tra bảo mật để tránh trở thành mục tiêu tấn công.</li>
</ul>
<hr>
<h2 id="references">References</h2>
<p><a href="https://portswigger.net/web-security/sql-injection/cheat-sheet" target="_blank" rel="noopener noreffer ">SQL Injection cheat sheet - PortSwigger</a></p>
<p><a href="https://wordpress.org/plugins/online-accessibility/" target="_blank" rel="noopener noreffer "> WordPress Accessibility Suite Plugin &lt;= 4.18 is vulnerable to SQL Injection </a></p>
<hr>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Cập nhật ngày 2025-09-26</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/vi/2025-09-26-cve-2025-32650/index.md" target="_blank">Đọc với định dạng Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Chia sẻ trên X" data-sharer="x" data-url="http://localhost:1313/vi/2025-09-26-cve-2025-32650/" data-title="CVE-2025-32650 Analysis &amp; POC" data-hashtags="analyst,plugin,sqli"><i class="fab fa-x-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Chia sẻ trên Threads" data-sharer="threads" data-url="http://localhost:1313/vi/2025-09-26-cve-2025-32650/" data-title="CVE-2025-32650 Analysis &amp; POC"><i class="fab fa-threads fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Chia sẻ trên Facebook" data-sharer="facebook" data-url="http://localhost:1313/vi/2025-09-26-cve-2025-32650/" data-hashtag="analyst"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Chia sẻ trên Hacker News" data-sharer="hackernews" data-url="http://localhost:1313/vi/2025-09-26-cve-2025-32650/" data-title="CVE-2025-32650 Analysis &amp; POC"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Chia sẻ trên Line" data-sharer="line" data-url="http://localhost:1313/vi/2025-09-26-cve-2025-32650/" data-title="CVE-2025-32650 Analysis &amp; POC"><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Chia sẻ trên 微博" data-sharer="weibo" data-url="http://localhost:1313/vi/2025-09-26-cve-2025-32650/" data-title="CVE-2025-32650 Analysis &amp; POC" data-image="app.png"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Chia sẻ trên Diaspora" data-sharer="diaspora" data-url="http://localhost:1313/vi/2025-09-26-cve-2025-32650/" data-title="CVE-2025-32650 Analysis &amp; POC" data-description="Security Vulnerability in WordPress Accessibility Suite Plugin."><i class="fab fa-diaspora fa-fw" aria-hidden="true"></i></a><a href="https://t.me/share/url?url=http%3a%2f%2flocalhost%3a1313%2fvi%2f2025-09-26-cve-2025-32650%2f&amp;text=CVE-2025-32650%20Analysis%20%26%20POC" target="_blank" title="Chia sẻ trên Telegram"><i class="fab fa-telegram fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/vi/tags/analyst/">Analyst</a>,&nbsp;<a href="/vi/tags/plugin/">Plugin</a>,&nbsp;<a href="/vi/tags/sqli/">Sqli</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Quay lại</a></span>&nbsp;|&nbsp;<span><a href="/vi/">Trang chủ</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/vi/2025-09-25-cve-2025-58604/" class="prev" rel="prev" title="CVE-2025-58604 Analysis &amp; POC"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>CVE-2025-58604 Analysis & POC</a>
            <a href="/vi/2025-09-27-cve-2025-48281/" class="next" rel="next" title="CVE-2025-48281 Analysis &amp; POC">CVE-2025-48281 Analysis & POC<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://w41bu1.github.io" target="_blank">w41bu1</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Lên trên">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a>
        </div>

        <div id="fixed-buttons-hidden"><a href="#" id="view-comments" class="fixed-button" title="Xem bình luận">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><script src="/lib/autocomplete/autocomplete.min.js"></script><script src="/lib/algoliasearch/lite/browser.umd.js"></script><script src="/lib/lazysizes/lazysizes.min.js"></script><script src="/lib/lightgallery/lightgallery.min.js"></script><script src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js"></script><script src="/lib/clipboard/clipboard.min.js"></script><script src="/lib/sharer/sharer.min.js"></script><script>window.config={"comment":{},"lightgallery":true,"search":{"algoliaAppID":"GZT24PWKNT","algoliaIndex":"index","algoliaSearchKey":"634ab679e825b815de2663de38908f9d","highlightTag":"em","maxResultLength":10,"noResultsFound":"Không tìm thấy","snippetLength":50,"type":"algolia"}};</script><script src="/js/theme.min.js"></script></body>
</html>
